{
  "address": "0xcdd10",
  "rules": [
    "populate SysWhispers2 syscall list/074b321f7b7941958bfc8de4f583b5b2",
    "hash data using aphash/e04b32e4de024de7af9a97876e98ac22",
    "connect to WMI namespace via WbemLocator/472165133b624c67bbc5d17c3915a018",
    "check Internet connectivity via WinINet/4ebebc1fd30e4dc8aec0393f85edc8f3",
    "contain loop",
    "hash data with CRC32/b31bffa9a15b460bbcbd04d2822872fb",
    "check OS version/35d8fd86b2bf418898b01c7af02eb9bc",
    "write file on Windows/dbc9cc37967145a499adfa89f5005055",
    "check OS version/a792de506c61438eae0e98a59003db67",
    "check for kernel debugger via shared user data structure/6be60e61779449d185f0bab196679834",
    "encrypt data using XTEA/5c1c4c90f3124e8b8e496a40b647bc29/85d53756af1244948e9b515ea3abe5ce",
    "validate payment card number using luhn algorithm with no lookup table/2ca16ccf2c974f3f90e3b8d02944442a",
    "check for time delay via GetTickCount/173be9e5d4d440c09f85224fcb793b6a"
  ],
  "disassembly": [
    "endbr64 ",
    "push    rbp {__saved_rbp}",
    "mov     rbp, rsp {__saved_rbp}",
    "push    r15 {__saved_r15}",
    "push    r14 {__saved_r14}",
    "lea     r14, [rel data_121b99]",
    "push    r13 {__saved_r13}",
    "lea     r13, [rel jump_table_1377b4]",
    "push    r12 {__saved_r12}",
    "mov     r12, rdi",
    "push    rbx {__saved_rbx}",
    "xor     ebx, ebx  {0x0}",
    "sub     rsp, 0x18",
    "lea     r15, [rel loptend]",
    "lea     rax, [rel lcurrent]",
    "mov     qword [rel data_168d30], 0x0",
    "mov     dword [rel data_168d28], 0x1",
    "mov     qword [r15], 0x0  {loptend}",
    "mov     qword [rax], 0x0  {lcurrent}",
    "mov     eax, ebx",
    "mov     r15, qword [r15]  {loptend}",
    "and     eax, 0x3",
    "cmp     eax, 0x3",
    "je      0xce123",
    "cmp     eax, 0xffffff9d",
    "je      0xcdf10",
    "mov     edx, 0x5",
    "lea     rsi, [rel data_1343f8]  {\"cannot set and unset shell optio\u2026\"}",
    "xor     edi, edi  {0x0}",
    "mov     ebx, 0x1",
    "call    dcgettext",
    "mov     rdi, rax",
    "xor     eax, eax  {0x0}",
    "call    builtin_error",
    "jmp     0xcdefa",
    "mov     edx, ebx",
    "and     edx, 0xb",
    "cmp     edx, 0x8",
    "je      0xce02b",
    "call    builtin_help",
    "jmp     0xcdef5",
    "sub     eax, 0x6f",
    "cmp     eax, 0x6",
    "ja      0xcdef0",
    "add     rsp, 0x18",
    "mov     eax, ebx",
    "pop     rbx {__saved_rbx}",
    "pop     r12 {__saved_r12}",
    "pop     r13 {__saved_r13}",
    "pop     r14 {__saved_r14}",
    "pop     r15 {__saved_r15}",
    "pop     rbp {__saved_rbp}",
    "retn     {__return_addr}",
    "mov     r12d, ebx",
    "mov     r13d, ebx",
    "xor     r14d, r14d  {0x0}",
    "and     r12d, 0x4",
    "and     r13d, 0x10",
    "test    r15, r15",
    "jne     0xce085",
    "mov     edx, ebx",
    "and     edx, 0x8",
    "test    r15, r15",
    "je      0xcdfec",
    "mov     ebx, 0x102",
    "{Case 0x3, 0x5}",
    "call    builtin_usage",
    "movsxd  rax, dword [r13+rax*4]",
    "add     rax, r13",
    "jmp     rax",
    "mov     rax, qword [r15+0x8]",
    "mov     rdi, qword [rax]",
    "call    minus_o_option_value",
    "cmp     eax, 0xffffffff",
    "je      0xce0f1",
    "jmp     0xce1f9",
    "mov     ecx, ebx",
    "and     ecx, 0x4",
    "test    edx, edx",
    "jne     0xce165",
    "test    edx, edx",
    "jne     0xcdf17",
    "{Case 0x6}",
    "mov     rsi, r14  {data_121b99, \"psuoq\"}",
    "mov     rdi, r12",
    "or      ebx, 0x2",
    "call    internal_getopt",
    "cmp     eax, 0xffffffff",
    "jne     0xcdd79",
    "{Case 0x4}",
    "or      ebx, 0x1",
    "jmp     0xcdd69",
    "{Case 0x2}",
    "or      ebx, 0x4",
    "jmp     0xcdd69",
    "{Case 0x1}",
    "or      ebx, 0x10",
    "jmp     0xcdd69",
    "{Case 0x0}",
    "or      ebx, 0x8",
    "jmp     0xcdd69",
    "mov     rax, qword [r15+0x8]",
    "xor     edi, edi  {0x0}",
    "mov     edx, 0x5",
    "lea     rsi, [rel data_1210b0]  {\"%s: invalid option name\"}",
    "mov     rbx, qword [rax]",
    "call    dcgettext",
    "mov     rdi, rax",
    "mov     rsi, rbx",
    "xor     eax, eax  {0x0}",
    "call    builtin_error",
    "jmp     0xce09f",
    "test    eax, eax",
    "jne     0xce050",
    "and     ebx, 0x4",
    "jne     0xce024",
    "test    ecx, ecx",
    "jne     0xce024",
    "test    eax, eax",
    "jne     0xce183",
    "and     ebx, 0x1",
    "mov     r13d, 0x1",
    "cmp     ebx, 0x1",
    "sbb     r12d, r12d",
    "xor     ebx, ebx  {0x0}",
    "and     r12d, 0xfffffffe",
    "add     r12d, 0x2d",
    "test    eax, eax",
    "jne     0xce14a",
    "nop     dword [rax+rax]",
    "mov     rsi, r14  {data_121b99, \"psuoq\"}",
    "mov     rdi, r12",
    "call    internal_getopt",
    "cmp     eax, 0xffffffff",
    "je      0xcddb8",
    "mov     r14d, 0x1",
    "jmp     0xce07d",
    "test    r12d, r12d",
    "jne     0xce07d",
    "test    r12d, r12d",
    "je      0xce0a7",
    "xor     edi, edi  {0x0}",
    "jmp     0xcde99",
    "mov     edi, 0xffffffff",
    "mov     esi, r13d",
    "call    list_minus_o_opts",
    "xor     edi, edi  {0x0}",
    "jmp     0xcde99",
    "mov     esi, ebx",
    "and     ebx, 0x1",
    "mov     edi, ebx",
    "and     esi, 0x10",
    "call    list_minus_o_opts",
    "xor     edi, edi  {0x0}",
    "jmp     0xcde99",
    "mov     r13d, ebx",
    "lea     r12, [rel data_156088]",
    "lea     rdx, [rel data_11f1dc]  {\"autocd\"}",
    "and     r13d, 0x1",
    "test    ecx, ecx",
    "sete    r14b",
    "nop     ",
    "lea     r13, [rel data_156088]",
    "lea     rdx, [rel data_11f1dc]  {\"autocd\"}",
    "mov     rax, qword [r15+0x8]",
    "mov     edi, r12d",
    "mov     rsi, qword [rax]",
    "call    set_minus_o_option",
    "mov     r15, qword [r15]",
    "cmp     eax, 0x1",
    "cmove   ebx, r13d  {0x1}",
    "test    r15, r15",
    "jne     0xcdf30",
    "call    set_shellopts",
    "jmp     0xcdefa",
    "add     rsp, 0x18",
    "and     ebx, 0x1",
    "mov     rsi, r15",
    "mov     edi, ebx",
    "pop     rbx {__saved_rbx}",
    "pop     r12 {__saved_r12}",
    "pop     r13 {__saved_r13}",
    "pop     r14 {__saved_r14}",
    "pop     r15 {__saved_r15}",
    "pop     rbp {__saved_rbp}",
    "jmp     sub_11a4d0",
    "mov     dword [rbp-0x3c {var_44_1}], 0x0",
    "nop     dword [rax]",
    "mov     r15, qword [r15]",
    "test    r15, r15",
    "je      0xce0c0",
    "test    r13d, r13d",
    "je      0xce11a",
    "test    r13d, r13d",
    "je      0xce0c8",
    "add     rsp, 0x18",
    "pop     rbx {__saved_rbx}",
    "pop     r12 {__saved_r12}",
    "pop     r13 {__saved_r13}",
    "pop     r14 {__saved_r14}",
    "pop     r15 {__saved_r15}",
    "pop     rbp {__saved_rbp}",
    "jmp     sh_chkwrite",
    "mov     rdx, qword [r12+0x10]",
    "add     r12, 0x18",
    "test    rdx, rdx",
    "jne     0xce1a0",
    "test    r14b, r14b",
    "jne     0xce1c5",
    "lea     r15, [rel data_11f1e9]",
    "lea     r14, [rel data_122c8a[0x12]]",
    "lea     r12, [rel data_11f1e6]",
    "jmp     0xce290",
    "mov     rdx, qword [r13+0x10]",
    "add     r13, 0x18",
    "test    rdx, rdx",
    "jne     0xce00f",
    "cmp     r12b, al",
    "jne     0xcde30",
    "mov     edi, r14d",
    "jmp     0xcde99",
    "lea     rcx, [rel data_122c8a[0x12]]  {\"on\"}",
    "jmp     0xce0d5",
    "mov     rax, qword [r15+0x8]",
    "mov     edx, 0x2d",
    "mov     rcx, qword [rax]",
    "mov     r14d, 0x1",
    "lea     rcx, [rel data_11f1e9]",
    "mov     rax, qword [r15+0x8]",
    "mov     r14d, 0x1",
    "mov     edx, 0x2b",
    "mov     rcx, qword [rax]",
    "jmp     0xce06a",
    "mov     rax, qword [r12]",
    "mov     eax, dword [rax]",
    "cmp     r13d, eax",
    "jne     0xce1b0",
    "xor     edi, edi  {0x0}",
    "jmp     0xcde99",
    "test    bl, 0x10",
    "je      0xce216",
    "mov     rax, qword [r13]",
    "mov     eax, dword [rax]",
    "test    bl, 0x10",
    "jne     0xce259",
    "test    ecx, ecx",
    "je      0xce242",
    "mov     rsi, qword [r14]",
    "add     r14, 0x18",
    "add     r13d, 0x1",
    "test    rsi, rsi",
    "je      0xcdf90",
    "mov     rdi, qword [rbp-0x38 {var_40_1}]",
    "call    strcmp",
    "test    eax, eax",
    "jne     0xcde30",
    "mov     rax, qword [r15+0x8]",
    "lea     rsi, [rel data_11f242]  {\"%-15s\\t%s\\n\"}",
    "mov     edi, 0x2",
    "mov     rdx, qword [rax]",
    "xor     eax, eax  {0x0}",
    "call    __printf_chk",
    "jmp     0xce07d",
    "lea     rsi, [rel data_121690]  {\"set %co %s\\n\"}",
    "mov     edi, 0x2",
    "xor     eax, eax  {0x0}",
    "call    __printf_chk",
    "test    eax, eax",
    "lea     rcx, [rel data_11f1e9]",
    "mov     edi, 0x2",
    "lea     rax, [rel data_122c8a[0x12]]",
    "lea     rsi, [rel data_11f242]  {\"%-15s\\t%s\\n\"}",
    "cmovne  rcx, rax  {data_122c8a[0x12], \"on\"}",
    "xor     eax, eax  {0x0}",
    "call    __printf_chk",
    "jmp     0xce1b0",
    "test    eax, eax",
    "lea     rcx, [rel data_11f1e3]",
    "mov     edi, 0x2",
    "lea     rax, [rel data_11f1e6]",
    "lea     rsi, [rel data_11f235]  {\"shopt %s %s\\n\"}",
    "cmovne  rax, rcx  {data_11f1e3}",
    "mov     rcx, rdx",
    "mov     rdx, rax",
    "xor     eax, eax  {0x0}",
    "call    __printf_chk",
    "jmp     0xce1b0",
    "test    eax, eax",
    "lea     rax, [rel data_11f1e3]",
    "mov     rcx, rdx",
    "cmove   rax, r12  {data_11f1e6}",
    "lea     rsi, [rel data_11f235]  {\"shopt %s %s\\n\"}",
    "mov     rdx, rax",
    "test    eax, eax",
    "mov     rcx, r14  {data_122c8a[0x12], \"on\"}",
    "lea     rsi, [rel data_11f242]  {\"%-15s\\t%s\\n\"}",
    "cmove   rcx, r15  {data_11f1e9}",
    "jmp     0xce273",
    "xor     edi, edi  {0x0}",
    "mov     edx, 0x5",
    "lea     rsi, [rel data_121b34]  {\"%s: invalid shell option name\"}",
    "call    dcgettext",
    "mov     rsi, qword [rbp-0x38 {var_40_1}]",
    "mov     rdi, rax",
    "xor     eax, eax  {0x0}",
    "call    builtin_error",
    "jmp     0xcde83",
    "movzx   eax, byte [rsi]",
    "movsxd  rcx, r13d",
    "mov     eax, ebx",
    "lea     rdx, [rcx+rcx*2]",
    "lea     rcx, [rel data_156080]",
    "and     eax, 0x4",
    "mov     rdx, qword [rcx+rdx*8+0x8]",
    "mov     edx, dword [rdx]",
    "test    edx, edx",
    "jne     0xcdf58",
    "mov     edi, 0x2",
    "xor     eax, eax  {0x0}",
    "add     r13, 0x18",
    "call    __printf_chk",
    "mov     rdx, qword [r13-0x8]",
    "test    rdx, rdx",
    "je      0xce024",
    "mov     dword [rbp-0x3c {var_44_1}], 0x1",
    "test    eax, eax",
    "jne     0xcde8a",
    "test    eax, eax",
    "je      0xcdfb6",
    "mov     rax, qword [r15+0x8]",
    "lea     r14, [rel data_156098]",
    "xor     r13d, r13d  {0x0}",
    "lea     rsi, [rel data_11f1dc]  {\"autocd\"}",
    "mov     rax, qword [rax]",
    "mov     qword [rbp-0x38 {var_40_1}], rax",
    "movzx   r12d, byte [rax]",
    "mov     eax, 0x61",
    "jmp     0xcde47",
    "mov     edi, dword [rbp-0x3c {var_44_1}]",
    "mov     r15, qword [r15]",
    "test    r15, r15",
    "jne     0xcde00",
    "lea     rdx, [rel data_11f1e3]",
    "test    bl, 0x10",
    "jne     0xcdfd0",
    "mov     dword [rbp-0x3c {var_44_1}], 0x1",
    "lea     rcx, [rel data_11f1e9]",
    "test    bl, 0x10",
    "je      0xcdf73",
    "mov     rcx, qword [rbp-0x38 {var_40_1}]",
    "lea     rsi, [rel data_11f235]  {\"shopt %s %s\\n\"}",
    "mov     edi, 0x2",
    "xor     eax, eax  {0x0}",
    "call    __printf_chk",
    "jmp     0xcde8a",
    "lea     rcx, [rel data_122c8a[0x12]]  {\"on\"}",
    "mov     rdx, qword [rbp-0x38 {var_40_1}]",
    "lea     rsi, [rel data_11f242]  {\"%-15s\\t%s\\n\"}",
    "mov     edi, 0x2",
    "xor     eax, eax  {0x0}",
    "call    __printf_chk",
    "jmp     0xcde8a",
    "lea     rdx, [rel data_11f1e6]"
  ],
  "high level IL": [
    "int32_t rbx = 0",
    "__builtin_memset(&data_168d30, 0, 0x18)",
    "data_168d28 = 1",
    "label_cdd6f:",
    "int32_t rax_1 = internal_getopt(arg1, \"psuoq\")",
    "if (rax_1 != 0xffffffff)",
    "while (true)",
    "if (rax_1 == 0xffffff9d)",
    "builtin_help()",
    "uint64_t rax_2 = zx.q(rax_1 - 0x6f)",
    "if (rax_2.d u<= 6)",
    "switch (rax_2)",
    "case 0",
    "rbx |= 8",
    "goto label_cdd6f",
    "case 1",
    "rbx |= 0x10",
    "goto label_cdd6f",
    "case 2",
    "rbx |= 4",
    "goto label_cdd6f",
    "case 4",
    "rbx |= 1",
    "goto label_cdd6f",
    "case 6",
    "rbx |= 2",
    "rax_1 = internal_getopt(arg1, \"psuoq\")",
    "if (rax_1 == 0xffffffff)",
    "break",
    "continue",
    "builtin_usage()",
    "return 0x102",
    "uint64_t loptend_1 = loptend",
    "int32_t rax_6 = rbx & 3",
    "int32_t rbx_1",
    "if (rax_6 == 3)",
    "rbx_1 = 1",
    "builtin_error(dcgettext(nullptr, \"cannot set and unset shell optio\u2026\", 5), 0)",
    "uint64_t rdx_2 = zx.q(rbx) & 0xb",
    "if (rdx_2.d == 8)",
    "int32_t r14_3 = 0",
    "int32_t r12_6 = rbx & 4",
    "int32_t r13_4 = rbx & 0x10",
    "if (loptend_1 == 0)",
    "if ((rbx & 4) != 0)",
    "return sh_chkwrite(0) __tailcall",
    "list_minus_o_opts(0xffffffff, r13_4, rdx_2)",
    "return sh_chkwrite(0) __tailcall",
    "int32_t rax_23 = minus_o_option_value(**(loptend_1 + 8))",
    "if (rax_23 == 0xffffffff)",
    "**(loptend_1 + 8)",
    "builtin_error(dcgettext(nullptr, \"%s: invalid option name\", 5), 0)",
    "r14_3 = 1",
    "if (rax_23 != 0)",
    "if (r12_6 == 0)",
    "if (r13_4 == 0)",
    "__printf_chk(2, \"%-15s\\t%s\\n\", **(loptend_1 + 8), \"on\")",
    "__printf_chk(2, \"set %co %s\\n\", 0x2d, **(loptend_1 + 8))",
    "if (r12_6 != 0)",
    "r14_3 = 1",
    "if (r13_4 == 0)",
    "r14_3 = 1",
    "__printf_chk(2, \"%-15s\\t%s\\n\", **(loptend_1 + 8), &data_11f1e9)",
    "r14_3 = 1",
    "__printf_chk(2, \"set %co %s\\n\", 0x2b, **(loptend_1 + 8))",
    "loptend_1 = *loptend_1",
    "do while (loptend_1 != 0)",
    "return sh_chkwrite(r14_3) __tailcall",
    "uint64_t rdx_4 = zx.q(rbx) & 8",
    "if (loptend_1 == 0)",
    "int32_t rcx_6 = rbx & 4",
    "if (rdx_4.d != 0)",
    "if (rcx_6 != 0)",
    "return sh_chkwrite(0) __tailcall",
    "list_minus_o_opts(rbx & 1, rbx & 0x10, rdx_4)",
    "return sh_chkwrite(0) __tailcall",
    "if (rax_6 != 0)",
    "void** const r12_7 = &data_156088",
    "char const* const i = \"autocd\"",
    "while (i != 0)",
    "int32_t rax_32 = **r12_7",
    "if ((rbx & 1) == rax_32 && rcx_6 == 0 != 0)",
    "if ((rbx.b & 0x10) == 0)",
    "__printf_chk(2, \"%-15s\\t%s\\n\")",
    "void* const rax_33 = &data_11f1e6",
    "if (rax_32 != 0)",
    "rax_33 = &data_11f1e3",
    "__printf_chk(2, \"shopt %s %s\\n\", rax_33, i)",
    "i = r12_7[2]",
    "r12_7 = &r12_7[3]",
    "return sh_chkwrite(0) __tailcall",
    "void** const r13_2 = &data_156088",
    "char const* const i_1 = \"autocd\"",
    "while (i_1 != 0)",
    "if (rcx_6 == 0)",
    "int32_t rax_38 = **r13_2",
    "char const* const i_3",
    "char* format",
    "if ((rbx.b & 0x10) != 0)",
    "char* i_2 = &data_11f1e3",
    "i_3 = i_1",
    "if (rax_38 == 0)",
    "i_2 = &data_11f1e6",
    "format = \"shopt %s %s\\n\"",
    "i_1 = i_2",
    "i_3 = \"on\"",
    "format = \"%-15s\\t%s\\n\"",
    "if (rax_38 == 0)",
    "i_3 = &data_11f1e9",
    "r13_2 = &r13_2[3]",
    "__printf_chk(2, format, i_1, i_3)",
    "i_1 = r13_2[-1]",
    "do while (i_1 != 0)",
    "break",
    "i_1 = r13_2[2]",
    "r13_2 = &r13_2[3]",
    "return sh_chkwrite(0) __tailcall",
    "if (rdx_4.d == 0)",
    "if (rax_6 != 0)",
    "return sub_11a4d0(rbx & 1, loptend_1) __tailcall",
    "int32_t var_44_1 = 0",
    "while (true)",
    "char const (** const r14_2)[0x12] = &data_156098",
    "int32_t r13_1 = 0",
    "char const* const rsi_1 = \"autocd\"",
    "char* rax_8 = **(loptend_1 + 8)",
    "char r12_1 = *rax_8",
    "char const rax_9 = 0x61",
    "while (true)",
    "int32_t rax_10",
    "if (r12_1 == rax_9)",
    "rax_10 = strcmp(rax_8, rsi_1)",
    "if (r12_1 != rax_9 || rax_10 != 0)",
    "rsi_1 = *r14_2",
    "r14_2 = &r14_2[3]",
    "r13_1 += 1",
    "if (rsi_1 == 0)",
    "builtin_error(dcgettext(nullptr, \"%s: invalid shell option name\", 5), 0)",
    "rax_9 = *rsi_1",
    "continue",
    "int32_t rax_12 = rbx & 4",
    "if (*(&data_156088)[sx.q(r13_1) * 3] != 0)",
    "if (rax_12 != 0)",
    "break",
    "if ((rbx.b & 0x10) != 0)",
    "__printf_chk(2, \"shopt %s %s\\n\", &data_11f1e3, rax_8)",
    "break",
    "__printf_chk(2, \"%-15s\\t%s\\n\", rax_8, \"on\")",
    "break",
    "if (rax_12 == 0)",
    "var_44_1 = 1",
    "if ((rbx.b & 0x10) == 0)",
    "__printf_chk(2, \"%-15s\\t%s\\n\", rax_8, &data_11f1e9)",
    "break",
    "__printf_chk(2, \"shopt %s %s\\n\", &data_11f1e6, rax_8)",
    "break",
    "var_44_1 = 1",
    "break",
    "loptend_1 = *loptend_1",
    "if (loptend_1 == 0)",
    "break",
    "return sh_chkwrite(var_44_1) __tailcall",
    "rbx_1 = 0",
    "int32_t rax_16 = set_minus_o_option((sbb.d(arg1.d, arg1.d, (rbx & 1) u< 1) & 0xfffffffe) + 0x2d, **(loptend_1 + 8))",
    "loptend_1 = *loptend_1",
    "if (rax_16 == 1)",
    "rbx_1 = 1",
    "do while (loptend_1 != 0)",
    "set_shellopts()",
    "return zx.q(rbx_1)"
  ]
}